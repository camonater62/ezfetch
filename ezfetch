#! /bin/sh
# ezfetch - the lightest and simplest *fetch out there.
# created by LonelyPyxel and modified by camonater62

HOST="$(hostname)" #Gets Hostname
KERNEL="$(uname -mrs)" #Gets Kernel
SHELL="$(echo $SHELL | cut -c 6-)" #Gets Shell
if [ -n "$DISPLAY" ]; then #Credit to Mitya on IRC for this func.			# Gets the window Manager
	id="$(xprop -root -notype | \awk '$1=="_NET_SUPPORTING_WM_CHECK:"{print $5}')" 
	wm="$(xprop -id "$id" -notype -f _NET_WM_NAME 8t)"
	wm="${wm/*_NET_WM_NAME = }"
	wm="${wm/\"}"
	wm="${wm/\"*}"
fi

#source: https://unix.stackexchange.com/questions/6345/how-can-i-get-distribution-name-and-version-number-in-a-simple-shell-script
OS=$(awk '/DISTRIB_ID=/' /etc/*-release | sed 's/DISTRIB_ID=//' | tr '[:upper:]' '[:lower:]') # Gets the distro
ARCH=$(uname -m | sed 's/x86_//;s/i[3-6]86/32/') # Gets the bit version of the distro
VERSION=$(awk '/DISTRIB_RELEASE=/' /etc/*-release | sed 's/DISTRIB_RELEASE=//' | sed 's/[.]0/./') # Gets version release date
RAM=$(free -m | awk 'NR==2{printf "%s/%sMB (%.2f%%)\n", $3,$2,$3*100/$2 }') # Gets the amount of RAM and usage
CPU=$(awk 'BEGIN{FS=":"} /model name/ { print $2; exit }' /proc/cpuinfo | awk 'BEGIN{FS=" @"; OFS="\n"} { print $1; exit }') # Gets the CPU model
GPU=$(lspci -mm | awk -F '\\"|\\" \\"|\\(' '/"Display|"3D|"VGA/ {a[$0] = $3 " " $4} END{for(i in a) {if(!seen[a[i]]++) print a[i]}}')

if [ -z "$OS" ]; then
    OS=$(awk '{print $1}' /etc/*-release | tr '[:upper:]' '[:lower:]')
fi

if [ -z "$VERSION" ]; then
    VERSION=$(awk '{print $3}' /etc/*-release)
fi

if [ "$XDG_CURRENT_DESKTOP" = "" ]						# Gets DE
then
  desktop=$(echo "$XDG_DATA_DIRS" | sed 's/.*\(xfce\|kde\|gnome\).*/\1/')
else
  desktop=$XDG_CURRENT_DESKTOP
fi

NC='\033[0m' # No Color

# Here's where it displays everything!
echo " E \033[1;37m██\033[0;30m██ ${NC}Distro:         $OS $ARCH bit
 Z \033[0;34m██\033[1;34m██ ${NC}Release:        $VERSION 
 F \033[0;32m██\033[1;32m██ ${NC}Kernel:         $KERNEL
 E \033[0;36m██\033[1;36m██ ${NC}Host:           $HOST
 T \033[0;31m██\033[1;31m██ ${NC}WM / DE:        $wm / $desktop
 C \033[0;35m██\033[1;35m██ ${NC}Shell:          $SHELL
 H \033[0;33m██\033[1;33m██ ${NC}CPU / GPU:     $CPU / $GPU
1.6\033[1;30m██\033[0;37m██ ${NC}Ram:            $RAM"
