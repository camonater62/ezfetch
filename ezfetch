#! /bin/sh
# ezfetch - the lightest and simplest fetch out there.
# this version is modified by camonater62

# Hostname
HOST="$(hostname)"

# Kernel
KERNEL="$(uname -mrs)"

# Shell
SHELL="$(echo $SHELL | cut -c 6-)"

# Window Manager
if [ -n "$DISPLAY" ]; then
  ID="$(xprop -root -notype _NET_SUPPORTING_WM_CHECK)"
  ID="$(echo $ID | cut -c 39-)"
  WM="$(xprop -id "$ID" -notype -len 100 -f _NET_WM_NAME 8t | grep "WM_NAME = " | cut -c 17- | rev | cut -c 2- | rev | tr -d '\n')"
fi
if [ "$WM" = "" ]; then
  WM="N/A"
fi

# Distro
OS=$(lsbrelease -si)

# Distro Arch
ARCH=$(uname -m | sed 's/x86//;s/i[3-6]86/32/')

# Distro Version
VERSION=$(lsb_release -sr)

# Ram & Current Usage
RAM=$(free -m | awk 'NR==2{printf "%s/%sMB (%.2f%%)\n", $3,$2,$3100/$2 }')

# CPU Model
CPU=$(awk 'BEGIN{FS=":"} /model name/ { print $2; exit }' /proc/cpuinfo | awk 'BEGIN{FS=" @"; OFS="\n"} { print $1; exit }' | cut -c 2-)

# GPU Model
GPU=$(lspci -mm | awk -F '\"|\" \"|\(' '/"Display|"3D|"VGA/ {a[$0] = $3 " " $4} END{for(i in a) {if(!seen[a[i]]++) print a[i]}}')

# Desktop Environment
if [ "$XDG_CURRENT_DESKTOP" = "" ]; then
  if [ "$XDG_DATA_DIRS" = "/usr/local/share:/usr/share:/var/lib/snapd/desktop" ]; then
    DESKTOP=""
  else
    DESKTOP=$(echo "$XDG_DATA_DIRS" | sed 's/.(xfce|kde|gnome)./\1/')
  fi
else
  DESKTOP=$XDG_CURRENT_DESKTOP
fi
if [ "$DESKTOP" = "" ]; then
  DESKTOP="N/A"
fi

# No Color
NC='\033[0m'

# Here's where it displays everything!
echo " E \033[1;37m██\033[0;30m██ ${NC}Distro:         $OS $VERSION $ARCH bit
 Z \033[0;34m██\033[1;34m██ ${NC}Kernel:         $KERNEL
 F \033[0;32m██\033[1;32m██ ${NC}Host:           $HOST
 E \033[0;36m██\033[1;36m██ ${NC}WM / DE:        $WM / $DESKTOP
 T \033[0;31m██\033[1;31m██ ${NC}Shell:          $SHELL
 C \033[0;35m██\033[1;35m██ ${NC}CPU:            $CPU
 H \033[0;33m██\033[1;33m██ ${NC}GPU:            $GPU
1.7\033[1;30m██\033[0;37m██ ${NC}Ram:            $RAM"
